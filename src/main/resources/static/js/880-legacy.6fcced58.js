"use strict";(self["webpackChunkpaike_sut"]=self["webpackChunkpaike_sut"]||[]).push([[880],{78880:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});t(67437),t(9910),t(20877),t(97579),t(28474),t(76905),t(83069),t(172),t(89007),t(70451),t(86809),t(56512),t(33877),t(17960),t(67219);var i=t(4143),r=t(54827),s=t(61832),a=t(41015),u=t(43209),l=t(10426),o=t(73060),c=t(76739),f=t(71267),d=t(59374),h=t(57927),p=t(61244),m=(t(47042),t(74916),t(64765),t(73396)),y=t(87139),g=t(49242),w=function(e){return(0,m.dD)("data-v-09208b60"),e=e(),(0,m.Cn)(),e},b=w((function(){return(0,m._)("h4",null,"申请实验室报修",-1)})),S=w((function(){return(0,m._)("br",null,null,-1)})),z={style:{display:"flex","align-items":"center"}},x=w((function(){return(0,m._)("p",{style:{"margin-right":"1rem"}},"学院",-1)})),_=w((function(){return(0,m._)("p",{style:{"margin-right":"1rem"}},"实验室",-1)})),W=(0,m.Uk)("非设备报修"),k=(0,m.Uk)("设备报修"),C=(0,m.Uk)("学院"),v=(0,m.Uk)("实验室"),V=(0,m.Uk)("设备"),L=w((function(){return(0,m._)("br",null,null,-1)})),U={style:{display:"flex","align-items":"center"}},Y=w((function(){return(0,m._)("span",null,"故障信息",-1)})),I=w((function(){return(0,m._)("br",null,null,-1)})),O={style:{"text-align":"center"}},R=(0,m.Uk)("确定"),D=(0,m.Uk)("学院"),B=(0,m.Uk)("实验室门牌号"),J=(0,m.Uk)("实验室类型"),N=w((function(){return(0,m._)("br",null,null,-1)})),$={style:{display:"flex","align-items":"center"}},j=w((function(){return(0,m._)("span",null,"故障信息",-1)})),H=w((function(){return(0,m._)("br",null,null,-1)})),P={style:{"text-align":"center"}},T=(0,m.Uk)("确定");function M(e,n,t,w,M,K){var Q=p.os,Z=h.BT,q=h.km,A=d.m,E=f.mi,F=c.Mr,G=u.$Y,X=o.EZ,ee=l.R,ne=u.eI,te=(0,m.up)("i-tickets"),ie=a.gn,re=s.QQ,se=(0,m.up)("i-location-information"),ae=(0,m.up)("i-timer"),ue=s.Lf,le=r.d0,oe=i.Kf;return(0,m.wg)(),(0,m.j4)(oe,{class:"account-container"},{default:(0,m.w5)((function(){return[b,(0,m.Wm)(Q),S,(0,m.Wm)(F,{always:!0},{default:(0,m.w5)((function(){return[(0,m._)("div",z,[x,(0,m.Wm)(q,{modelValue:w.YxsOption,"onUpdate:modelValue":n[0]||(n[0]=function(e){return w.YxsOption=e}),placeholder:"选择学院",onChange:K.changeYxs,style:{"margin-right":"1rem"}},{default:(0,m.w5)((function(){return[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(M.YxsList,(function(e,n){return(0,m.wg)(),(0,m.j4)(Z,{key:n,label:e.dwmc,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"]),_,(0,m.Wm)(A,{placeholder:"选择实验室",modelValue:w.SysCascaderOption,"onUpdate:modelValue":n[1]||(n[1]=function(e){return w.SysCascaderOption=e}),options:K.getSysCascader,onChange:K.changeCascader,style:{"margin-right":"1rem"},filterable:""},null,8,["modelValue","options","onChange"]),(0,m.Wm)(E,{type:"danger",onClick:K.applySysRepair},{default:(0,m.w5)((function(){return[W]})),_:1},8,["onClick"])])]})),_:1}),(0,m.Wm)(ne,{data:K.sbTableInfo.slice((M.currentPage-1)*M.pagesize,M.currentPage*M.pagesize),style:{width:"100%"}},{append:(0,m.w5)((function(){return[(0,m.Wm)(ee,{onSizeChange:K.handleSizeChange,onCurrentChange:K.handleCurrentChange,"current-page":M.currentPage,"page-sizes":[5,10,20,40],"page-size":M.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:K.sbTableInfo.length},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]})),default:(0,m.w5)((function(){return[(0,m.Wm)(G,{type:"index"}),(0,m.Wm)(G,{label:"设备名称",prop:"sbmc",width:"220rem"}),(0,m.Wm)(G,{label:"设备状态",prop:"state",width:"220rem"}),(0,m.Wm)(G,{label:"故障信息",prop:"info",width:"220rem"}),(0,m.Wm)(G,{label:"设备报修",width:"300rem"},{header:(0,m.w5)((function(){return[(0,m.Wm)(X,{modelValue:M.search,"onUpdate:modelValue":n[2]||(n[2]=function(e){return M.search=e}),placeholder:"输入设备名称搜索"},null,8,["modelValue"])]})),default:(0,m.w5)((function(e){return[0==e.row.sbzt?((0,m.wg)(),(0,m.j4)(E,{key:0,type:"danger",onClick:function(n){return K.applyRepair(e.row)},text:""},{default:(0,m.w5)((function(){return[k]})),_:2},1032,["onClick"])):(0,m.kq)("",!0)]})),_:1})]})),_:1},8,["data"]),(0,m.Wm)(le,{modelValue:w.repairDialogVisible,"onUpdate:modelValue":n[5]||(n[5]=function(e){return w.repairDialogVisible=e}),title:"申请设备报修",width:"40%","before-close":w.handleClose},{default:(0,m.w5)((function(){return[(0,m.Wm)(ue,{column:1,border:""},{default:(0,m.w5)((function(){return[(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(te)]})),_:1}),C]})),default:(0,m.w5)((function(){return[(0,m.Uk)((0,y.zw)(M.Yxs.dwmc),1)]})),_:1}),(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(se)]})),_:1}),v]})),default:(0,m.w5)((function(){return[(0,m.Uk)((0,y.zw)(M.Sys.sysmph)+" "+(0,y.zw)(M.Sys.sysmc),1)]})),_:1}),(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(ae)]})),_:1}),V]})),default:(0,m.w5)((function(){return[(0,m.Uk)(" "+(0,y.zw)(M.Sb.sbmc),1)]})),_:1})]})),_:1}),(0,m.Wm)(Q),L,(0,m._)("div",U,[Y,(0,m.Wm)(X,{style:{"margin-right":"1rem"},modelValue:M.SbgzInfo,"onUpdate:modelValue":n[3]||(n[3]=function(e){return M.SbgzInfo=e}),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"必需输入"},null,8,["modelValue"])]),I,(0,m._)("div",O,[(0,m.Wm)(E,{size:"large",type:"primary",style:{width:"6rem"},onClick:n[4]||(n[4]=(0,g.iM)((function(e){return K.applyRepairButton()}),["prevent"]))},{default:(0,m.w5)((function(){return[R]})),_:1})])]})),_:1},8,["modelValue","before-close"]),(0,m.Wm)(le,{modelValue:w.repairSysDialogVisible,"onUpdate:modelValue":n[8]||(n[8]=function(e){return w.repairSysDialogVisible=e}),title:"申请实验室报修",width:"40%","before-close":w.handleClose},{default:(0,m.w5)((function(){return[(0,m.Wm)(ue,{column:1,border:""},{default:(0,m.w5)((function(){return[(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(te)]})),_:1}),D]})),default:(0,m.w5)((function(){return[(0,m.Uk)((0,y.zw)(M.Yxs.dwmc),1)]})),_:1}),(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(se)]})),_:1}),B]})),default:(0,m.w5)((function(){return[(0,m.Uk)((0,y.zw)(M.Sys.sysmph),1)]})),_:1}),(0,m.Wm)(re,null,{label:(0,m.w5)((function(){return[(0,m.Wm)(ie,null,{default:(0,m.w5)((function(){return[(0,m.Wm)(ae)]})),_:1}),J]})),default:(0,m.w5)((function(){return[(0,m.Uk)(" "+(0,y.zw)(M.Sys.sysmc),1)]})),_:1})]})),_:1}),N,(0,m._)("div",$,[j,(0,m.Wm)(X,{style:{"margin-right":"1rem"},modelValue:M.SysgzInfo,"onUpdate:modelValue":n[6]||(n[6]=function(e){return M.SysgzInfo=e}),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"必需输入"},null,8,["modelValue"])]),H,(0,m._)("div",P,[(0,m.Wm)(E,{size:"large",type:"primary",style:{width:"6rem"},onClick:n[7]||(n[7]=(0,g.iM)((function(e){return K.sysRepairButton()}),["prevent"]))},{default:(0,m.w5)((function(){return[T]})),_:1})])]})),_:1},8,["modelValue","before-close"])]})),_:1})}var K=t(61897),Q=t(85574),Z=(t(93970),t(77233),t(38862),t(69826),t(41539),t(47941),t(51532),t(78783),t(33948),t(21249),t(57327),t(26699),t(32023),t(44870)),q={setup:function(){var e=(0,Z.iH)(""),n=(0,Z.iH)([]),t=(0,Z.iH)(!1),i=(0,Z.iH)(!1),r=function(e){K.T.confirm("确定关闭对话框?","温馨提示",{type:"info",center:!0}).then((function(){e()}))};return{YxsOption:e,SysCascaderOption:n,repairDialogVisible:t,handleClose:r,repairSysDialogVisible:i}},data:function(){return{currentPage:1,pagesize:10,search:"",YxsList:[],Yxs:{},SysList:[],Sys:{},sbList:[],Sb:{},SbgzInfo:"",SysgzInfo:""}},created:function(){this.getYxsList()},methods:{handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},getYxsList:function(){var e=this;this.$axios.get("/weixin-yxs/getAllYxs").then((function(n){var t=n.data;200==t.code&&(e.YxsList=t.data)}))},devicelist:function(e){var n=this;this.$axios.post("/weixin-sbzk/deviceList",{sysh:e}).then((function(e){var t=e.data;200==t.code?n.sbList=t.data:Q.z8.error("获取设备列表失败")}))},getSysListById:function(e){var n=this;this.$axios.get("/weixin-syszk/getById?id="+e).then((function(e){var t=e.data;200==t.code&&(n.SysList=t.data)}))},changeYxs:function(){this.Yxs=JSON.parse(JSON.stringify(this.YxsOption)),this.YxsOption=this.Yxs.dwmc,this.SysCascaderOption="",Loading.show(),this.getSysListById(this.Yxs.dwh),Loading.hide()},changeCascader:function(e){this.Sys=JSON.parse(JSON.stringify(this.SysList.find((function(n){return n.sysh==e[1]})))),Loading.show(),this.devicelist(this.Sys.sysh),Loading.hide()},applyRepair:function(e){this.Sb=JSON.parse(JSON.stringify(e)),this.repairDialogVisible=!0},applyRepairButton:function(){var e=this;""!=this.SbgzInfo?this.$axios.post("/weixin-sbzk/repairSb",{sbh:this.Sb.sbh,info:this.SbgzInfo,sbzt:"2",sysh:this.Sys.sysh}).then((function(n){var t=n.data;200==t.code&&(Q.z8.success("申请成功"),e.devicelist(e.Sys.sysh),e.SbgzInfo="",e.repairDialogVisible=!1)})):Q.z8.error("填写故障信息")},applySysRepair:function(){0==Object.keys(this.Sys).length?Q.z8.error("请先选择实验室"):(console.log(this.Sys),"1"==this.Sys.systype?Q.z8.error("该实验室已经被禁用"):null!=this.Sys.info&&""!=this.Sys.info?Q.z8.error("该实验室已经申请过了报修"):this.repairSysDialogVisible=!0)},sysRepairButton:function(){var e=this;""!=this.SysgzInfo?this.$axios.post("/weixin-syszk/repairSys",{sysh:this.Sys.sysh,systype:"2",info:this.SysgzInfo}).then((function(n){var t=n.data;200==t.code&&(Q.z8.success("报修申请提交成功"),e.repairSysDialogVisible=!1,e.SysCascaderOption=[],Loading.show(),e.getSysListById(e.Yxs.dwh),Loading.hide())})).catch((function(e){Q.z8.error(e)})):Q.z8.error("填写故障信息")}},computed:{getSysCascader:function(){var e=[],n=new Map;return this.SysList.map((function(t){if(n.has(t.sysmc)){var i=n.get(t.sysmc);i.children.push({value:t.sysh,label:t.sysmph})}else{i={};i.value=t.yxsh,i.label=t.sysmc,i.children=[{value:t.sysh,label:t.sysmph}],n.set(t.sysmc,i),e.push(i)}})),e},sbTableInfo:function(){var e=this;return this.sbList.map((function(e){return 0==e.sbzt?e["state"]="开放":1==e.sbzt?e["state"]="禁用":e["state"]="报修",e})).filter((function(n){return!e.search||n.sbmc.includes(e.search.toLowerCase())}))}}},A=t(40089);const E=(0,A.Z)(q,[["render",M],["__scopeId","data-v-09208b60"]]);var F=E},86809:function(e,n,t){t(11758)},67437:function(e,n,t){t(11758)},56512:function(e,n,t){t(11758),t(172),t(86467),t(31430),t(88),t(83429),t(70451)},88:function(e,n,t){t(11758)},97579:function(e,n,t){t(11758)},20877:function(e,n,t){t(11758),t(97579)},9910:function(e,n,t){t(11758),t(47195)},67219:function(e,n,t){t(11758)},172:function(e,n,t){t(11758)},93970:function(e,n,t){t(11758),t(86809),t(172),t(47195)},17960:function(e,n,t){t(11758)},47195:function(e,n,t){t(11758)},83069:function(e,n,t){t(11758),t(33877)},83429:function(e,n,t){t(11758)},70451:function(e,n,t){t(11758)},33877:function(e,n,t){t(11758),t(172),t(31430),t(17960),t(70451),t(86467)},89007:function(e,n,t){t(11758),t(88),t(31430)},76905:function(e,n,t){t(11758),t(88),t(31430),t(44566),t(70451)}}]);
//# sourceMappingURL=880-legacy.6fcced58.js.map