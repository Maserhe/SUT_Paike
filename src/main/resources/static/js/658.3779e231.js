"use strict";(self["webpackChunkpaike_sut"]=self["webpackChunkpaike_sut"]||[]).push([[658],{3658:function(e,s,t){t.r(s),t.d(s,{default:function(){return ee}});t(7437),t(1758),t(8474),t(9910),t(33),t(6226),t(2064),t(3429),t(7113),t(6905),t(3069),t(3855),t(172),t(9007),t(451),t(6809),t(3877),t(7960),t(7219);var a=t(4143),l=t(9523),d=t(1015),o=t(4827),i=t(1853),n=t(7188),m=t(3732),u=t(3209),c=t(426),r=t(2563),y=t(3060),f=t(6739),h=t(1267),p=t(7927),b=t(1244),w=t(3396);const g=e=>((0,w.dD)("data-v-393561fb"),e=e(),(0,w.Cn)(),e),S=g((()=>(0,w._)("h4",null,"实验室管理",-1))),I=g((()=>(0,w._)("br",null,null,-1))),_={style:{display:"flex","align-items":"center"}},W=g((()=>(0,w._)("p",{style:{"margin-right":"1rem"}},"学院",-1))),x=(0,w.Uk)("添加实验室"),V=(0,w.Uk)("管理"),k=(0,w.Uk)("删除"),C=(0,w.Uk)("开放"),z=(0,w.Uk)("禁用"),v={style:{margin:"0 auto"}},L=(0,w.Uk)("更新"),U=(0,w.Uk)("重置"),Y=(0,w.Uk)("删除"),D=(0,w.Uk)("正常"),$=(0,w.Uk)("故障"),q={style:{margin:"0 auto"}},F=(0,w.Uk)("添加"),B=(0,w.Uk)("重置"),R=(0,w.Uk)("开放"),T=(0,w.Uk)("禁用"),O={style:{margin:"0 auto"}},N=(0,w.Uk)("添加"),M=(0,w.Uk)("重置"),P={style:{"text-align":"center"}},A=g((()=>(0,w._)("div",{class:"el-upload__text"},[(0,w.Uk)("拖拽文件到这或者"),(0,w._)("em",null,"点击上传")],-1))),H=g((()=>(0,w._)("div",{class:"el-upload__tip"},"需要上传指定格式的csv文件,请先下载模版,仿照着写",-1))),J=g((()=>(0,w._)("a",{href:"/addLabs.csv",download:"addLabs.csv"},"模版下载",-1)));function j(e,s,t,g,j,K){const Z=b.os,E=p.BT,G=p.km,Q=h.mi,X=f.Mr,ee=u.$Y,se=y.EZ,te=r.i1,ae=c.R,le=u.eI,de=n.nH,oe=m.rh,ie=m.KD,ne=n.ly,me=i.p8,ue=i.Ub,ce=o.d0,re=(0,w.up)("i-upload-filled"),ye=d.gn,fe=l.LW,he=a.Kf;return(0,w.wg)(),(0,w.j4)(he,{class:"account-container"},{default:(0,w.w5)((()=>[S,(0,w.Wm)(Z),I,(0,w.Wm)(X,null,{default:(0,w.w5)((()=>[(0,w._)("div",_,[W,(0,w.Wm)(G,{modelValue:j.YxsOption,"onUpdate:modelValue":s[0]||(s[0]=e=>j.YxsOption=e),placeholder:"Select",onChange:K.changeYxs,style:{"margin-right":"1rem"}},{default:(0,w.w5)((()=>[((0,w.wg)(!0),(0,w.iD)(w.HY,null,(0,w.Ko)(j.YxsList,((e,s)=>((0,w.wg)(),(0,w.j4)(E,{key:s,label:e.dwmc,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),(0,w.Wm)(Q,{type:"primary",style:{display:"inline-block"},onClick:K.addSysDialog},{default:(0,w.w5)((()=>[x])),_:1},8,["onClick"])])])),_:1}),(0,w.Wm)(le,{data:K.getSysFilter.slice((j.currentPage-1)*j.pagesize,j.currentPage*j.pagesize),style:{width:"100%"}},{append:(0,w.w5)((()=>[(0,w.Wm)(ae,{onSizeChange:K.handleSizeChange,onCurrentChange:K.handleCurrentChange,"current-page":j.currentPage,"page-sizes":[5,10,20,40],"page-size":j.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:K.getSysFilter.length},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])),default:(0,w.w5)((()=>[(0,w.Wm)(ee,{type:"index"}),(0,w.Wm)(ee,{label:"实验名称",prop:"sysmc",width:"220rem"}),(0,w.Wm)(ee,{label:"门牌号",prop:"sysmph"}),(0,w.Wm)(ee,{label:"容量",prop:"capacity"}),(0,w.Wm)(ee,{label:"状态",prop:"state"}),(0,w.Wm)(ee,{label:"操作",width:"300rem"},{header:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.search,"onUpdate:modelValue":s[1]||(s[1]=e=>j.search=e),placeholder:"输入实验室门牌号、名称、状态过滤"},null,8,["modelValue"])])),default:(0,w.w5)((e=>[(0,w.Wm)(Q,{type:"primary",onClick:s=>K.changeSysInfo(e.row)},{default:(0,w.w5)((()=>[V])),_:2},1032,["onClick"]),(0,w.Wm)(te,{title:"确定要删除该实验室?",onConfirm:s=>K.deleteSysById(e.row.sysh)},{reference:(0,w.w5)((()=>[(0,w.Wm)(Q,{type:"danger"},{default:(0,w.w5)((()=>[k])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),(0,w.Wm)(ce,{modelValue:g.dialogVisible,"onUpdate:modelValue":s[12]||(s[12]=e=>g.dialogVisible=e),title:"实验室管理",width:"60%","before-close":g.handleClose},{default:(0,w.w5)((()=>[(0,w.Wm)(ue,{onTabClick:K.tabsClick},{default:(0,w.w5)((()=>[(0,w.Wm)(me,{label:"修改实验室信息",name:"first"},{default:(0,w.w5)((()=>[(0,w.Wm)(ne,{ref:"sysInfoRef",model:j.SysInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((()=>[(0,w.Wm)(de,{label:"实验室的名称",prop:"sysmc",rules:[{required:!0,message:"必需填写,例如: 人工智能实验室, 例如: 机房"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.SysInfo.sysmc,"onUpdate:modelValue":s[2]||(s[2]=e=>j.SysInfo.sysmc=e),type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室门牌号",prop:"sysmph",rules:[{required:!0,message:"必需填写,表示实验室位置,例如: 205"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.SysInfo.sysmph,"onUpdate:modelValue":s[3]||(s[3]=e=>j.SysInfo.sysmph=e),type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室的容量",prop:"capacity",rules:[{required:!0,message:"必需填写,实验室的人数,例如: 40"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.SysInfo.capacity,"onUpdate:modelValue":s[4]||(s[4]=e=>j.SysInfo.capacity=e),type:"number",min:"0",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室的类型",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(ie,{modelValue:j.SysInfo.systype,"onUpdate:modelValue":s[5]||(s[5]=e=>j.SysInfo.systype=e)},{default:(0,w.w5)((()=>[(0,w.Wm)(oe,{label:"0"},{default:(0,w.w5)((()=>[C])),_:1}),(0,w.Wm)(oe,{label:"1"},{default:(0,w.w5)((()=>[z])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,w.Wm)(de,null,{default:(0,w.w5)((()=>[(0,w._)("div",v,[(0,w.Wm)(Q,{type:"primary",onClick:s[6]||(s[6]=e=>K.updateSysInfo("sysInfoRef"))},{default:(0,w.w5)((()=>[L])),_:1}),(0,w.Wm)(Q,{onClick:s[7]||(s[7]=e=>K.resetForm("sysInfoRef"))},{default:(0,w.w5)((()=>[U])),_:1})])])),_:1})])),_:1},8,["model"])])),_:1}),(0,w.Wm)(me,{label:"设备管理",name:"second"},{default:(0,w.w5)((()=>[(0,w.Wm)(le,{data:K.sbTableInfo,style:{width:"100%"}},{default:(0,w.w5)((()=>[(0,w.Wm)(ee,{type:"index"}),(0,w.Wm)(ee,{label:"设备名称",prop:"sbmc",width:"220rem"}),(0,w.Wm)(ee,{label:"设备状态",prop:"state",width:"220rem"}),(0,w.Wm)(ee,{label:"操作",width:"300rem"},{default:(0,w.w5)((e=>[(0,w.Wm)(te,{title:"确定要删除该实验室?",onConfirm:s=>K.deleteDevice(e.row.sbh)},{reference:(0,w.w5)((()=>[(0,w.Wm)(Q,{type:"danger"},{default:(0,w.w5)((()=>[Y])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,w.Wm)(me,{label:"添加设备",name:"third"},{default:(0,w.w5)((()=>[(0,w.Wm)(ne,{ref:"addSbInfoRef",model:j.addSbInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((()=>[(0,w.Wm)(de,{label:"设备的名称",prop:"sysmc",rules:[{required:!0,message:"必需填写,例如: 投影仪"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.addSbInfo.sbmc,"onUpdate:modelValue":s[8]||(s[8]=e=>j.addSbInfo.sbmc=e),type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"设备的状态",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(ie,{modelValue:j.addSbInfo.sbzt,"onUpdate:modelValue":s[9]||(s[9]=e=>j.addSbInfo.sbzt=e)},{default:(0,w.w5)((()=>[(0,w.Wm)(oe,{label:"0"},{default:(0,w.w5)((()=>[D])),_:1}),(0,w.Wm)(oe,{label:"1"},{default:(0,w.w5)((()=>[$])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,w.Wm)(de,null,{default:(0,w.w5)((()=>[(0,w._)("div",q,[(0,w.Wm)(Q,{type:"primary",onClick:s[10]||(s[10]=e=>K.addSb())},{default:(0,w.w5)((()=>[F])),_:1}),(0,w.Wm)(Q,{onClick:s[11]||(s[11]=e=>K.resetForm("addSbInfoRef"))},{default:(0,w.w5)((()=>[B])),_:1})])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1},8,["onTabClick"])])),_:1},8,["modelValue","before-close"]),(0,w.Wm)(ce,{modelValue:g.addDialogVisible,"onUpdate:modelValue":s[20]||(s[20]=e=>g.addDialogVisible=e),title:"添加实验室",width:"60%","before-close":g.handleClose},{default:(0,w.w5)((()=>[(0,w.Wm)(ue,{modelValue:j.activeName,"onUpdate:modelValue":s[19]||(s[19]=e=>j.activeName=e),onTabClick:K.handleClick},{default:(0,w.w5)((()=>[(0,w.Wm)(me,{label:"单个添加",name:"first"},{default:(0,w.w5)((()=>[(0,w.Wm)(ne,{ref:"addSysInfoRef",model:j.addSysInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((()=>[(0,w.Wm)(de,{label:"实验室的名称",prop:"sysmc",rules:[{required:!0,message:"非必需填写,例如: 人工智能实验室, 不填写的话默认名称: 机房"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.addSysInfo.sysmc,"onUpdate:modelValue":s[13]||(s[13]=e=>j.addSysInfo.sysmc=e),type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室门牌号",prop:"sysmph",rules:[{required:!0,message:"必需填写,表示实验室位置,例如: 205"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.addSysInfo.sysmph,"onUpdate:modelValue":s[14]||(s[14]=e=>j.addSysInfo.sysmph=e),type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室的容量",prop:"capacity",rules:[{required:!0,message:"必需填写,实验室的人数,例如: 40"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(se,{modelValue:j.addSysInfo.capacity,"onUpdate:modelValue":s[15]||(s[15]=e=>j.addSysInfo.capacity=e),type:"number",min:"0",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,w.Wm)(de,{label:"实验室的类型",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((()=>[(0,w.Wm)(ie,{modelValue:j.addSysInfo.systype,"onUpdate:modelValue":s[16]||(s[16]=e=>j.addSysInfo.systype=e)},{default:(0,w.w5)((()=>[(0,w.Wm)(oe,{label:"0"},{default:(0,w.w5)((()=>[R])),_:1}),(0,w.Wm)(oe,{label:"1"},{default:(0,w.w5)((()=>[T])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,w.Wm)(de,null,{default:(0,w.w5)((()=>[(0,w._)("div",O,[(0,w.Wm)(Q,{type:"primary",onClick:s[17]||(s[17]=e=>K.addSys("addSysInfoRef"))},{default:(0,w.w5)((()=>[N])),_:1}),(0,w.Wm)(Q,{onClick:s[18]||(s[18]=e=>K.resetForm("addSysInfoRef"))},{default:(0,w.w5)((()=>[M])),_:1})])])),_:1})])),_:1},8,["model"])])),_:1}),(0,w.Wm)(me,{label:"批量添加",name:"second"},{default:(0,w.w5)((()=>[(0,w._)("div",P,[(0,w.Wm)(fe,{drag:"",action:"","http-request":K.uploadCSVFile,limit:1,accept:".csv"},{tip:(0,w.w5)((()=>[H])),default:(0,w.w5)((()=>[(0,w.Wm)(ye,{class:"el-icon--upload"},{default:(0,w.w5)((()=>[(0,w.Wm)(re)])),_:1}),A])),_:1},8,["http-request"]),(0,w.Wm)(Q,{type:"primary"},{default:(0,w.w5)((()=>[J])),_:1})])])),_:1})])),_:1},8,["modelValue","onTabClick"])])),_:1},8,["modelValue","before-close"])])),_:1})}var K=t(1897),Z=t(5574),E=(t(3970),t(7233),t(4870)),G={setup(){const e=(0,E.iH)(!1),s=(0,E.iH)(!1),t=e=>{K.T.confirm("确定关闭对话框?","温馨提示",{type:"info",center:!0}).then((()=>{e()}))};return{dialogVisible:e,handleClose:t,addDialogVisible:s}},data(){return{currentPage:1,pagesize:10,search:"",YxsList:[],YxsOption:"选择学院",YxsId:"",YxsMc:"",SysList:[],SysInfo:{sysh:"",sysmc:"",sysmph:"",systype:"",yxsh:"",yxmc:""},activeName:"first",addSysInfo:{sysmc:"",sysmph:"",capacity:"",systype:"0"},sbList:[],addSbInfo:{sysh:"",sbmc:"",sbzt:"0"}}},created(){this.getYxsList()},methods:{handleClick(e,s){console.log(e,s)},clearSysInfo(){this.SysInfo={sysh:"",sysmc:"",sysmph:"",yxsh:"",yxmc:"",capacity:"",systype:0}},claearAddSbInfo(){this.addSbInfo={sysh:"",sbmc:"",sbzt:"0"}},resetForm(e){this.$refs[e].resetFields(),this.clearSysInfo(),this.claearAddSbInfo()},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},getYxsList(){this.$axios.get("/weixin-yxs/getAllYxs").then((e=>{const s=e.data;200==s.code&&(this.YxsList=s.data)}))},changeYxs(e){e.dwh?(this.YxsOption=e.dwmc,this.YxsId=e.dwh,this.YxsMc=e.dwmc,Loading.show(),this.getSysListById(e.dwh),Loading.hide()):Z.z8.error("请选择学院")},getSysListById(e){this.$axios.get("/weixin-syszk/getById?id="+e).then((e=>{const s=e.data;200==s.code&&(this.SysList=s.data)}))},deleteSysById(e){this.$axios.post("/weixin-syszk/deleteById?id="+e).then((e=>{const s=e.data;200==s.code?(Z.z8.success("删除成功"),Loading.show(),this.getSysListById(this.YxsId),Loading.hide()):Z.z8.error("删除错误")}))},changeSysInfo(e){this.SysInfo=null,this.dialogVisible=!0,console.log(JSON.parse(JSON.stringify(e))),this.SysInfo=JSON.parse(JSON.stringify(e)),Loading.show(),this.devicelist(this.SysInfo.sysh),Loading.hide()},updateSysInfo(e){this.$refs[e].validate((e=>{e?this.$axios.post("/weixin-syszk/updateSysInfo",{sysh:this.SysInfo.sysh,sysmc:this.SysInfo.sysmc,sysmph:this.SysInfo.sysmph,capacity:this.SysInfo.capacity,systype:this.SysInfo.systype}).then((e=>{const s=e.data;200==s.code&&(Z.z8.success("更新数据成功"),this.dialogVisible=!1,this.getSysListById(this.YxsId))})):Z.z8.error("表单不合法！！")}))},addSysDialog(){if(!this.YxsId)return Z.z8.error("请选择学院,如果旁边选择框没有选项,请刷新页面"),!1;this.addDialogVisible=!0},addSys(e){this.$refs[e].validate((e=>{e&&this.$axios.post("/weixin-syszk/addSys",{sysmc:this.addSysInfo.sysmc,sysmph:this.addSysInfo.sysmph,capacity:this.addSysInfo.capacity,systype:this.addSysInfo.systype,yxsh:this.YxsId,yxmc:this.YxsMc}).then((e=>{const s=e.data;200==s.code?(Z.z8.success("添加成功"),Loading.show(),this.getSysListById(this.YxsId),Loading.hide(),this.addDialogVisible=!1):Z.z8.error(s.msg)}))}))},uploadCSVFile(e){const s=e.file;let t=new FormData;t.append("file",s),t.append("YxsId",this.YxsId),t.append("YxsMc",this.YxsMc),console.log(t),this.$axios({url:"/weixin-syszk/addSYSList",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((e=>{const s=e.data;200==s.code?(Z.z8.success("添加成功"),location.reload()):Z.z8.error(s.msg)}))},addSb(){""!=this.SysInfo.sysh&&(this.addSbInfo.sysh=this.SysInfo.sysh,Loading.show(),this.addDevice(),Loading.hide(),this.claearAddSbInfo())},devicelist(e){this.$axios.post("/weixin-sbzk/deviceList",{sysh:e}).then((e=>{const s=e.data;200==s.code?this.sbList=s.data:Z.z8.error("获取设备列表失败")}))},deleteDevice(e){this.$axios.post("/weixin-sbzk/deleteDevice",{sbh:e}).then((e=>{const s=e.data;200==s.code&&(this.devicelist(this.SysInfo.sysh),Z.z8.success("删除成功"))}))},addDevice(){""!=this.addSbInfo.sbmc&&""!=this.addSbInfo.sysh&&""!=this.addSbInfo.sbzt?this.$axios.post("/weixin-sbzk/addDevice",this.addSbInfo).then((e=>{const s=e.data;200==s.code&&(Z.z8.success("添加成功"),this.devicelist(this.SysInfo.sysh))})):Z.z8.error("请填写设备信息")},tabsClick(e){}},computed:{getSysFilter(){return this.SysList.map((e=>(0==e.systype?e["state"]="开放":1==e.systype?e["state"]="禁用":e["state"]="报修",e))).filter((e=>!this.search||e.sysmc.includes(this.search.toLowerCase())||e.sysmph.includes(this.search.toLowerCase())||e.state.includes(this.search.toLowerCase())))},sbTableInfo(){return this.sbList.map((e=>(e["state"]="0"==e.sbzt?"正常":"故障",e)))}}},Q=t(89);const X=(0,Q.Z)(G,[["render",j],["__scopeId","data-v-393561fb"]]);var ee=X},6809:function(e,s,t){t(1758)},7437:function(e,s,t){t(1758)},88:function(e,s,t){t(1758)},9910:function(e,s,t){t(1758),t(7195)},7219:function(e,s,t){t(1758)},7113:function(e,s,t){t(1758)},2064:function(e,s,t){t(1758)},172:function(e,s,t){t(1758)},3970:function(e,s,t){t(1758),t(6809),t(172),t(7195)},7960:function(e,s,t){t(1758)},7195:function(e,s,t){t(1758)},3069:function(e,s,t){t(1758),t(3877)},3855:function(e,s,t){t(1758),t(6962)},3429:function(e,s,t){t(1758)},451:function(e,s,t){t(1758)},3877:function(e,s,t){t(1758),t(172),t(1430),t(7960),t(451),t(6467)},6226:function(e,s,t){t(1758)},9007:function(e,s,t){t(1758),t(88),t(1430)},6905:function(e,s,t){t(1758),t(88),t(1430),t(4566),t(451)},33:function(e,s,t){t(1758)}}]);
//# sourceMappingURL=658.3779e231.js.map