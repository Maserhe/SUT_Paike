"use strict";(self["webpackChunkpaike_sut"]=self["webpackChunkpaike_sut"]||[]).push([[658],{3658:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee}});t(67437),t(11758),t(28474),t(9910),t(80033),t(46226),t(62064),t(83429),t(47113),t(76905),t(83069),t(53855),t(172),t(89007),t(70451),t(86809),t(33877),t(17960),t(67219);var s=t(4143),a=t(89523),o=t(41015),i=t(54827),u=t(51853),l=t(67188),r=t(3732),d=t(43209),c=t(10426),f=t(42563),m=t(73060),y=t(76739),p=t(71267),h=t(57927),b=t(61244),w=(t(47042),t(74916),t(64765),t(73396)),g=function(e){return(0,w.dD)("data-v-393561fb"),e=e(),(0,w.Cn)(),e},S=g((function(){return(0,w._)("h4",null,"实验室管理",-1)})),I=g((function(){return(0,w._)("br",null,null,-1)})),_={style:{display:"flex","align-items":"center"}},W=g((function(){return(0,w._)("p",{style:{"margin-right":"1rem"}},"学院",-1)})),x=(0,w.Uk)("添加实验室"),V=(0,w.Uk)("管理"),v=(0,w.Uk)("删除"),k=(0,w.Uk)("开放"),C=(0,w.Uk)("禁用"),z={style:{margin:"0 auto"}},L=(0,w.Uk)("更新"),U=(0,w.Uk)("重置"),Y=(0,w.Uk)("删除"),D=(0,w.Uk)("正常"),$=(0,w.Uk)("故障"),q={style:{margin:"0 auto"}},F=(0,w.Uk)("添加"),B=(0,w.Uk)("重置"),R=(0,w.Uk)("开放"),T=(0,w.Uk)("禁用"),O={style:{margin:"0 auto"}},N=(0,w.Uk)("添加"),M=(0,w.Uk)("重置"),P={style:{"text-align":"center"}},A=g((function(){return(0,w._)("div",{class:"el-upload__text"},[(0,w.Uk)("拖拽文件到这或者"),(0,w._)("em",null,"点击上传")],-1)})),H=g((function(){return(0,w._)("div",{class:"el-upload__tip"},"需要上传指定格式的csv文件,请先下载模版,仿照着写",-1)})),J=g((function(){return(0,w._)("a",{href:"/addLabs.csv",download:"addLabs.csv"},"模版下载",-1)}));function j(e,n,t,g,j,K){var Z=b.os,E=h.BT,G=h.km,Q=p.mi,X=y.Mr,ee=d.$Y,ne=m.EZ,te=f.i1,se=c.R,ae=d.eI,oe=l.nH,ie=r.rh,ue=r.KD,le=l.ly,re=u.p8,de=u.Ub,ce=i.d0,fe=(0,w.up)("i-upload-filled"),me=o.gn,ye=a.LW,pe=s.Kf;return(0,w.wg)(),(0,w.j4)(pe,{class:"account-container"},{default:(0,w.w5)((function(){return[S,(0,w.Wm)(Z),I,(0,w.Wm)(X,null,{default:(0,w.w5)((function(){return[(0,w._)("div",_,[W,(0,w.Wm)(G,{modelValue:j.YxsOption,"onUpdate:modelValue":n[0]||(n[0]=function(e){return j.YxsOption=e}),placeholder:"Select",onChange:K.changeYxs,style:{"margin-right":"1rem"}},{default:(0,w.w5)((function(){return[((0,w.wg)(!0),(0,w.iD)(w.HY,null,(0,w.Ko)(j.YxsList,(function(e,n){return(0,w.wg)(),(0,w.j4)(E,{key:n,label:e.dwmc,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"]),(0,w.Wm)(Q,{type:"primary",style:{display:"inline-block"},onClick:K.addSysDialog},{default:(0,w.w5)((function(){return[x]})),_:1},8,["onClick"])])]})),_:1}),(0,w.Wm)(ae,{data:K.getSysFilter.slice((j.currentPage-1)*j.pagesize,j.currentPage*j.pagesize),style:{width:"100%"}},{append:(0,w.w5)((function(){return[(0,w.Wm)(se,{onSizeChange:K.handleSizeChange,onCurrentChange:K.handleCurrentChange,"current-page":j.currentPage,"page-sizes":[5,10,20,40],"page-size":j.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:K.getSysFilter.length},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]})),default:(0,w.w5)((function(){return[(0,w.Wm)(ee,{type:"index"}),(0,w.Wm)(ee,{label:"实验名称",prop:"sysmc",width:"220rem"}),(0,w.Wm)(ee,{label:"门牌号",prop:"sysmph"}),(0,w.Wm)(ee,{label:"容量",prop:"capacity"}),(0,w.Wm)(ee,{label:"状态",prop:"state"}),(0,w.Wm)(ee,{label:"操作",width:"300rem"},{header:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.search,"onUpdate:modelValue":n[1]||(n[1]=function(e){return j.search=e}),placeholder:"输入实验室门牌号、名称、状态过滤"},null,8,["modelValue"])]})),default:(0,w.w5)((function(e){return[(0,w.Wm)(Q,{type:"primary",onClick:function(n){return K.changeSysInfo(e.row)}},{default:(0,w.w5)((function(){return[V]})),_:2},1032,["onClick"]),(0,w.Wm)(te,{title:"确定要删除该实验室?",onConfirm:function(n){return K.deleteSysById(e.row.sysh)}},{reference:(0,w.w5)((function(){return[(0,w.Wm)(Q,{type:"danger"},{default:(0,w.w5)((function(){return[v]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:1})]})),_:1},8,["data"]),(0,w.Wm)(ce,{modelValue:g.dialogVisible,"onUpdate:modelValue":n[12]||(n[12]=function(e){return g.dialogVisible=e}),title:"实验室管理",width:"60%","before-close":g.handleClose},{default:(0,w.w5)((function(){return[(0,w.Wm)(de,{onTabClick:K.tabsClick},{default:(0,w.w5)((function(){return[(0,w.Wm)(re,{label:"修改实验室信息",name:"first"},{default:(0,w.w5)((function(){return[(0,w.Wm)(le,{ref:"sysInfoRef",model:j.SysInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((function(){return[(0,w.Wm)(oe,{label:"实验室的名称",prop:"sysmc",rules:[{required:!0,message:"必需填写,例如: 人工智能实验室, 例如: 机房"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.SysInfo.sysmc,"onUpdate:modelValue":n[2]||(n[2]=function(e){return j.SysInfo.sysmc=e}),type:"text",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室门牌号",prop:"sysmph",rules:[{required:!0,message:"必需填写,表示实验室位置,例如: 205"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.SysInfo.sysmph,"onUpdate:modelValue":n[3]||(n[3]=function(e){return j.SysInfo.sysmph=e}),type:"text",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室的容量",prop:"capacity",rules:[{required:!0,message:"必需填写,实验室的人数,例如: 40"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.SysInfo.capacity,"onUpdate:modelValue":n[4]||(n[4]=function(e){return j.SysInfo.capacity=e}),type:"number",min:"0",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室的类型",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ue,{modelValue:j.SysInfo.systype,"onUpdate:modelValue":n[5]||(n[5]=function(e){return j.SysInfo.systype=e})},{default:(0,w.w5)((function(){return[(0,w.Wm)(ie,{label:"0"},{default:(0,w.w5)((function(){return[k]})),_:1}),(0,w.Wm)(ie,{label:"1"},{default:(0,w.w5)((function(){return[C]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,null,{default:(0,w.w5)((function(){return[(0,w._)("div",z,[(0,w.Wm)(Q,{type:"primary",onClick:n[6]||(n[6]=function(e){return K.updateSysInfo("sysInfoRef")})},{default:(0,w.w5)((function(){return[L]})),_:1}),(0,w.Wm)(Q,{onClick:n[7]||(n[7]=function(e){return K.resetForm("sysInfoRef")})},{default:(0,w.w5)((function(){return[U]})),_:1})])]})),_:1})]})),_:1},8,["model"])]})),_:1}),(0,w.Wm)(re,{label:"设备管理",name:"second"},{default:(0,w.w5)((function(){return[(0,w.Wm)(ae,{data:K.sbTableInfo,style:{width:"100%"}},{default:(0,w.w5)((function(){return[(0,w.Wm)(ee,{type:"index"}),(0,w.Wm)(ee,{label:"设备名称",prop:"sbmc",width:"220rem"}),(0,w.Wm)(ee,{label:"设备状态",prop:"state",width:"220rem"}),(0,w.Wm)(ee,{label:"操作",width:"300rem"},{default:(0,w.w5)((function(e){return[(0,w.Wm)(te,{title:"确定要删除该实验室?",onConfirm:function(n){return K.deleteDevice(e.row.sbh)}},{reference:(0,w.w5)((function(){return[(0,w.Wm)(Q,{type:"danger"},{default:(0,w.w5)((function(){return[Y]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:1})]})),_:1},8,["data"])]})),_:1}),(0,w.Wm)(re,{label:"添加设备",name:"third"},{default:(0,w.w5)((function(){return[(0,w.Wm)(le,{ref:"addSbInfoRef",model:j.addSbInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((function(){return[(0,w.Wm)(oe,{label:"设备的名称",prop:"sysmc",rules:[{required:!0,message:"必需填写,例如: 投影仪"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.addSbInfo.sbmc,"onUpdate:modelValue":n[8]||(n[8]=function(e){return j.addSbInfo.sbmc=e}),type:"text",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"设备的状态",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ue,{modelValue:j.addSbInfo.sbzt,"onUpdate:modelValue":n[9]||(n[9]=function(e){return j.addSbInfo.sbzt=e})},{default:(0,w.w5)((function(){return[(0,w.Wm)(ie,{label:"0"},{default:(0,w.w5)((function(){return[D]})),_:1}),(0,w.Wm)(ie,{label:"1"},{default:(0,w.w5)((function(){return[$]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,null,{default:(0,w.w5)((function(){return[(0,w._)("div",q,[(0,w.Wm)(Q,{type:"primary",onClick:n[10]||(n[10]=function(e){return K.addSb()})},{default:(0,w.w5)((function(){return[F]})),_:1}),(0,w.Wm)(Q,{onClick:n[11]||(n[11]=function(e){return K.resetForm("addSbInfoRef")})},{default:(0,w.w5)((function(){return[B]})),_:1})])]})),_:1})]})),_:1},8,["model"])]})),_:1})]})),_:1},8,["onTabClick"])]})),_:1},8,["modelValue","before-close"]),(0,w.Wm)(ce,{modelValue:g.addDialogVisible,"onUpdate:modelValue":n[20]||(n[20]=function(e){return g.addDialogVisible=e}),title:"添加实验室",width:"60%","before-close":g.handleClose},{default:(0,w.w5)((function(){return[(0,w.Wm)(de,{modelValue:j.activeName,"onUpdate:modelValue":n[19]||(n[19]=function(e){return j.activeName=e}),onTabClick:K.handleClick},{default:(0,w.w5)((function(){return[(0,w.Wm)(re,{label:"单个添加",name:"first"},{default:(0,w.w5)((function(){return[(0,w.Wm)(le,{ref:"addSysInfoRef",model:j.addSysInfo,"label-position":"left",class:"sys-form"},{default:(0,w.w5)((function(){return[(0,w.Wm)(oe,{label:"实验室的名称",prop:"sysmc",rules:[{required:!0,message:"非必需填写,例如: 人工智能实验室, 不填写的话默认名称: 机房"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.addSysInfo.sysmc,"onUpdate:modelValue":n[13]||(n[13]=function(e){return j.addSysInfo.sysmc=e}),type:"text",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室门牌号",prop:"sysmph",rules:[{required:!0,message:"必需填写,表示实验室位置,例如: 205"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.addSysInfo.sysmph,"onUpdate:modelValue":n[14]||(n[14]=function(e){return j.addSysInfo.sysmph=e}),type:"text",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室的容量",prop:"capacity",rules:[{required:!0,message:"必需填写,实验室的人数,例如: 40"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ne,{modelValue:j.addSysInfo.capacity,"onUpdate:modelValue":n[15]||(n[15]=function(e){return j.addSysInfo.capacity=e}),type:"number",min:"0",autocomplete:"off"},null,8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,{label:"实验室的类型",rules:[{required:!0,message:"必需选择，默认开放"}]},{default:(0,w.w5)((function(){return[(0,w.Wm)(ue,{modelValue:j.addSysInfo.systype,"onUpdate:modelValue":n[16]||(n[16]=function(e){return j.addSysInfo.systype=e})},{default:(0,w.w5)((function(){return[(0,w.Wm)(ie,{label:"0"},{default:(0,w.w5)((function(){return[R]})),_:1}),(0,w.Wm)(ie,{label:"1"},{default:(0,w.w5)((function(){return[T]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,w.Wm)(oe,null,{default:(0,w.w5)((function(){return[(0,w._)("div",O,[(0,w.Wm)(Q,{type:"primary",onClick:n[17]||(n[17]=function(e){return K.addSys("addSysInfoRef")})},{default:(0,w.w5)((function(){return[N]})),_:1}),(0,w.Wm)(Q,{onClick:n[18]||(n[18]=function(e){return K.resetForm("addSysInfoRef")})},{default:(0,w.w5)((function(){return[M]})),_:1})])]})),_:1})]})),_:1},8,["model"])]})),_:1}),(0,w.Wm)(re,{label:"批量添加",name:"second"},{default:(0,w.w5)((function(){return[(0,w._)("div",P,[(0,w.Wm)(ye,{drag:"",action:"","http-request":K.uploadCSVFile,limit:1,accept:".csv"},{tip:(0,w.w5)((function(){return[H]})),default:(0,w.w5)((function(){return[(0,w.Wm)(me,{class:"el-icon--upload"},{default:(0,w.w5)((function(){return[(0,w.Wm)(fe)]})),_:1}),A]})),_:1},8,["http-request"]),(0,w.Wm)(Q,{type:"primary"},{default:(0,w.w5)((function(){return[J]})),_:1})])]})),_:1})]})),_:1},8,["modelValue","onTabClick"])]})),_:1},8,["modelValue","before-close"])]})),_:1})}var K=t(61897),Z=t(85574),E=(t(93970),t(77233),t(38862),t(57327),t(41539),t(21249),t(26699),t(32023),t(44870)),G={setup:function(){var e=(0,E.iH)(!1),n=(0,E.iH)(!1),t=function(e){K.T.confirm("确定关闭对话框?","温馨提示",{type:"info",center:!0}).then((function(){e()}))};return{dialogVisible:e,handleClose:t,addDialogVisible:n}},data:function(){return{currentPage:1,pagesize:10,search:"",YxsList:[],YxsOption:"选择学院",YxsId:"",YxsMc:"",SysList:[],SysInfo:{sysh:"",sysmc:"",sysmph:"",systype:"",yxsh:"",yxmc:""},activeName:"first",addSysInfo:{sysmc:"",sysmph:"",capacity:"",systype:"0"},sbList:[],addSbInfo:{sysh:"",sbmc:"",sbzt:"0"}}},created:function(){this.getYxsList()},methods:{handleClick:function(e,n){console.log(e,n)},clearSysInfo:function(){this.SysInfo={sysh:"",sysmc:"",sysmph:"",yxsh:"",yxmc:"",capacity:"",systype:0}},claearAddSbInfo:function(){this.addSbInfo={sysh:"",sbmc:"",sbzt:"0"}},resetForm:function(e){this.$refs[e].resetFields(),this.clearSysInfo(),this.claearAddSbInfo()},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e},getYxsList:function(){var e=this;this.$axios.get("/weixin-yxs/getAllYxs").then((function(n){var t=n.data;200==t.code&&(e.YxsList=t.data)}))},changeYxs:function(e){e.dwh?(this.YxsOption=e.dwmc,this.YxsId=e.dwh,this.YxsMc=e.dwmc,Loading.show(),this.getSysListById(e.dwh),Loading.hide()):Z.z8.error("请选择学院")},getSysListById:function(e){var n=this;this.$axios.get("/weixin-syszk/getById?id="+e).then((function(e){var t=e.data;200==t.code&&(n.SysList=t.data)}))},deleteSysById:function(e){var n=this;this.$axios.post("/weixin-syszk/deleteById?id="+e).then((function(e){var t=e.data;200==t.code?(Z.z8.success("删除成功"),Loading.show(),n.getSysListById(n.YxsId),Loading.hide()):Z.z8.error("删除错误")}))},changeSysInfo:function(e){this.SysInfo=null,this.dialogVisible=!0,console.log(JSON.parse(JSON.stringify(e))),this.SysInfo=JSON.parse(JSON.stringify(e)),Loading.show(),this.devicelist(this.SysInfo.sysh),Loading.hide()},updateSysInfo:function(e){var n=this;this.$refs[e].validate((function(e){e?n.$axios.post("/weixin-syszk/updateSysInfo",{sysh:n.SysInfo.sysh,sysmc:n.SysInfo.sysmc,sysmph:n.SysInfo.sysmph,capacity:n.SysInfo.capacity,systype:n.SysInfo.systype}).then((function(e){var t=e.data;200==t.code&&(Z.z8.success("更新数据成功"),n.dialogVisible=!1,n.getSysListById(n.YxsId))})):Z.z8.error("表单不合法！！")}))},addSysDialog:function(){if(!this.YxsId)return Z.z8.error("请选择学院,如果旁边选择框没有选项,请刷新页面"),!1;this.addDialogVisible=!0},addSys:function(e){var n=this;this.$refs[e].validate((function(e){e&&n.$axios.post("/weixin-syszk/addSys",{sysmc:n.addSysInfo.sysmc,sysmph:n.addSysInfo.sysmph,capacity:n.addSysInfo.capacity,systype:n.addSysInfo.systype,yxsh:n.YxsId,yxmc:n.YxsMc}).then((function(e){var t=e.data;200==t.code?(Z.z8.success("添加成功"),Loading.show(),n.getSysListById(n.YxsId),Loading.hide(),n.addDialogVisible=!1):Z.z8.error(t.msg)}))}))},uploadCSVFile:function(e){var n=e.file,t=new FormData;t.append("file",n),t.append("YxsId",this.YxsId),t.append("YxsMc",this.YxsMc),console.log(t),this.$axios({url:"/weixin-syszk/addSYSList",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){var n=e.data;200==n.code?(Z.z8.success("添加成功"),location.reload()):Z.z8.error(n.msg)}))},addSb:function(){""!=this.SysInfo.sysh&&(this.addSbInfo.sysh=this.SysInfo.sysh,Loading.show(),this.addDevice(),Loading.hide(),this.claearAddSbInfo())},devicelist:function(e){var n=this;this.$axios.post("/weixin-sbzk/deviceList",{sysh:e}).then((function(e){var t=e.data;200==t.code?n.sbList=t.data:Z.z8.error("获取设备列表失败")}))},deleteDevice:function(e){var n=this;this.$axios.post("/weixin-sbzk/deleteDevice",{sbh:e}).then((function(e){var t=e.data;200==t.code&&(n.devicelist(n.SysInfo.sysh),Z.z8.success("删除成功"))}))},addDevice:function(){var e=this;""!=this.addSbInfo.sbmc&&""!=this.addSbInfo.sysh&&""!=this.addSbInfo.sbzt?this.$axios.post("/weixin-sbzk/addDevice",this.addSbInfo).then((function(n){var t=n.data;200==t.code&&(Z.z8.success("添加成功"),e.devicelist(e.SysInfo.sysh))})):Z.z8.error("请填写设备信息")},tabsClick:function(e){}},computed:{getSysFilter:function(){var e=this;return this.SysList.map((function(e){return 0==e.systype?e["state"]="开放":1==e.systype?e["state"]="禁用":e["state"]="报修",e})).filter((function(n){return!e.search||n.sysmc.includes(e.search.toLowerCase())||n.sysmph.includes(e.search.toLowerCase())||n.state.includes(e.search.toLowerCase())}))},sbTableInfo:function(){return this.sbList.map((function(e){return e["state"]="0"==e.sbzt?"正常":"故障",e}))}}},Q=t(40089);const X=(0,Q.Z)(G,[["render",j],["__scopeId","data-v-393561fb"]]);var ee=X},86809:function(e,n,t){t(11758)},67437:function(e,n,t){t(11758)},88:function(e,n,t){t(11758)},9910:function(e,n,t){t(11758),t(47195)},67219:function(e,n,t){t(11758)},47113:function(e,n,t){t(11758)},62064:function(e,n,t){t(11758)},172:function(e,n,t){t(11758)},93970:function(e,n,t){t(11758),t(86809),t(172),t(47195)},17960:function(e,n,t){t(11758)},47195:function(e,n,t){t(11758)},83069:function(e,n,t){t(11758),t(33877)},53855:function(e,n,t){t(11758),t(16962)},83429:function(e,n,t){t(11758)},70451:function(e,n,t){t(11758)},33877:function(e,n,t){t(11758),t(172),t(31430),t(17960),t(70451),t(86467)},46226:function(e,n,t){t(11758)},89007:function(e,n,t){t(11758),t(88),t(31430)},76905:function(e,n,t){t(11758),t(88),t(31430),t(44566),t(70451)},80033:function(e,n,t){t(11758)}}]);
//# sourceMappingURL=658-legacy.a28c2b0a.js.map